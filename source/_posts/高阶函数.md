---
title: python高阶函数
summary: python四种高阶函数:filter、map、reduce和sorted
date: 2019-11-01
author: LY
categories:
    - 后端
tags:
    - python语法
---

## filter()函数

**简单的说就是过滤函数**

filter()是python内置的高阶函数，filter()函数接收一个函数 f 和一list，这个函数 f 的作用是对每个元素进行判断，返回 True或 False，filter()根据判断结果自动过滤掉不符合条件的元素，返回由符合条件元素组成的新list。

```python
 filter(function or None, sequence) -> list, tuple, or string
```

- function:接受一个参数，返回布尔值True或False
- sequence:序列可以是str，tuple，list



filter函数会对序列参数sequence中的每个元素调用function函数，最后返回的结果包含调用结果为**True**的元素。

返回值的类型和参数sequence的类型相同

这里拿个案例说明这个函数

```python
filter(lambda x: x%2, [1, 2, 3, 4])
[1, 3]
#在python中，非0为True
#1作为x，1%2=1为True。
#2作为x,2%2=0为Fasle。
#3作为x，3%2=1为True
#4作为x,4%2=0为Fasle

filter(None, "she")
'she'
```

其他案例如下

```python
#例如，要从一个list [1, 4, 6, 7, 9, 12, 17]中删除偶数，保留奇数，首先，要编写一个判断奇数的函数：
def is_odd(x):
    return x % 2 == 1
filter(is_odd, [1, 4, 6, 7, 9, 12, 17])

#结果[1, 7, 9, 17]
```

```python
#删除空字符串
def is_not_empty(s):
    return s and len(s.strip()) > 0
filter(is_not_empty, ['test', None, '', 'str', '  ', 'END'])

#结果['test', 'str', 'END']
```

```python
#返回1-100的所有的平方根为整数的数
import math
def is_sqr(x):
    r = int(math.sqrt(x))
    return r*r==x
print filter(is_sqr, range(1, 101))
```

&emsp;

## map()函数

**map函数会根据提供的函数对指定序列做映射**

**map()函数是python内置的高阶函数，可以把一个 list 转换为另一个 list，只需要传入转换函数**

```python
map(function, sequence[, sequence, ...]) -> list
```

- function:是一个函数
- sequence:是一个或多个序列,取决于function需要几个参数
- 返回值是一个list

案例如下：

```python
#函数需要一个参数
map(lambda x: x*x, [1, 2, 3])
#这里就是把1作为x，然后拿x平方
#2作为x，然后拿x去平方
#3作为x，然后拿3去平方。
#所以结果为:[1, 4, 9]

#函数需要两个参数
map(lambda x, y: x+y, [1, 2, 3], [4, 5, 6])
#取出1和4，然后拿1和4相加。
#取出2和5，然后拿2和5相加。
#取出3和6，然后拿3和6相加。
#结果为:[5, 7, 9]


def f1( x, y ):  
    return (x,y)

l1 = [ 0, 1, 2, 3, 4, 5, 6 ]  
l2 = [ 'Sun', 'M', 'T', 'W', 'T', 'F', 'S' ]
l3 = map( f1, l1, l2 ) 
print(list(l3))
#结果为:[(0, 'Sun'), (1, 'M'), (2, 'T'), (3, 'W'), (4, 'T'), (5, 'F'), (6, 'S')]
```

其余案例如下：

```python
#把[1, 2, 3, 4, 5, 6, 7, 8, 9]每个都平方
def f(x):
    return x*x
print map(f, [1, 2, 3, 4, 5, 6, 7, 8, 9])
```

```python
[1, 4, 9, 10, 25, 36, 49, 64, 81]
```

```python
#把首字母大写，其余的小写
def format_name(s):
    return s[0].upper() + s[1:].lower()
print map(format_name, ['adam', 'LISA', 'barT'])
```

```
['Adam', 'Lisa', 'Bart']
```

&emsp;

## reduce()函数

**reduce是一个累积函数**

reduce()函数是python的一个高阶计算函数，会对list的里面的每个元素不断的调用，方法和map函数类似，但是reduce接入的参数可以为两个或者三个

```python
reduce(function, sequence[, initial]) -> value
```

- function:该函数有两个参数
- sequence:序列可以是str，tuple，list
- initial:固定初始值

reduce依次从sequence中取一个元素，和上一次调用function的结果做参数再次调用function。 第一次调用function时，如果提供initial参数，会以sequence中的第一个元素和initial 作为参数调用function，否则会以序列sequence中的前两个元素做参数调用function。 注意function函数不能为None。

案例如下：

```python
reduce(lambda x, y: x+y, [1,2,3,4])
#10
#1作为x，2作为y，x+y=1+2=3，然后把得出的3赋值给x，把列表的3赋值给y，3+3=6，然后把6赋值给x，4赋值给y，x+y=10，得出最后结果为10
reduce(lambda x, y: x+y, [1,2,3,4], 5)
#15
#这里多加个5的意思是把5作为初始值x
#5作为x，从列表中取1作为y,5+1=6，6作为x，x作为y，6+2=8，8作为x，3组我诶y，8+3=11，11作为x，4作为y，11+4=15,得出最后的结果为15
reduce(lambda x, y: x+y, ['aa', 'bb', 'cc'], 'dd')
'ddaabbcc'
#原理和上面的一样
```



其余案例如下：

```python
def f(x, y):
    return x + y
reduce(f, [1, 3, 5, 7, 9])
```

```
结果为25
过程如下：
先计算头两个元素：f(1, 3)，结果为4；
再把结果和第3个元素计算：f(4, 5)，结果为9；
再把结果和第4个元素计算：f(9, 7)，结果为16；
再把结果和第5个元素计算：f(16, 9)，结果为25；
由于没有更多的元素了，计算结束，返回结果25。
```

&emsp;

## sorted()函数

**sorted是一个搜索函数**

```python
sorted(iterable, cmp=None, key=None, reverse=False) --> new sorted list
```

**sorted()**函数是python的一个高阶函数，可以接受函数来实现自定义排序，**sorted()**函数与**sort**函数是有一定区别的，比如

```python
a=['bob', 'about', 'Zoo', 'Credit']
a.sort()
print(a)
#['Credit', 'Zoo', 'about', 'bob']
#此时需要忽略大小写sort函数是不足以完成的
```

```python
#使用sorted函数
def cmp_ignore_case(s1, s2):
    u1 = s1.upper()
    u2 = s2.upper()
    if u1 < u2:
        return -1
    if u1 > u2:
        return 1
    return 0
print sorted(['bob', 'about', 'Zoo', 'Credit'], cmp_ignore_case)
#['about', 'bob', 'Credit', 'Zoo']
```

sorted()函数也可以对数字进行排序，**如果 x 应该排在 y 的前面，返回 -1，如果 x 应该排在 y 的后面，返回 1。如果 x 和 y 相等，返回 0**

假如要实现数字的倒序排序

```python
def reversed_cmp(x, y):
    if x > y:
        return -1
    if x < y:
        return 1
    return 0
sorted([36, 5, 12, 9, 21], reversed_cmp)
#[36, 21, 12, 9, 5]
```

假如要实现字符串的ASCII大小排序

```python
sorted(['bob', 'about', 'Zoo', 'Credit'])
#['Credit', 'Zoo', 'about', 'bob']
```

但是一般的排序的话使用sort足够了，除非要自定义排序才用sorted