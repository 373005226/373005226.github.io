---
title: Python闭包
summary: 详细讲解了python闭包的用法
date: 2019-10-18
author: LY
categories:
    - python
tags:
    - python语法
---

## 闭包定义

**闭包的作用通俗的来说就是强调，闭包可以用来在一个函数与一组“私有”变量之间创建关联关系。在给定函数被多次调用的过程中，这些私有变量能够保持其持久性**

闭包的基本形式如下：

```python
def demoA(number):
    print('--1--')
    def demoB():
        使用demoA的变量
    return demoB()
```



## 案例

```python
def demoA(number):
    print('--1--')
    def demoB(number2):
        print('--2--')
        print('demoA形参是',number,'demoB传入的形参是',number2)
    print('--3--')
    return demoB

res=demoA(100)
res(200)
```

```
--1--
--3--
--2--
demoA形参是 100 demoB传入的形参是 200
```

从上面的案例看出，在调用完demoA的时候，并没有把demoA销毁，返回值保存了demoB的引用，所以demoB里面还保存着demoA传入的变量



这里再拿个案例来说明，拿一个数学的二元函数来打比方`y=ax^2+b`,假如a和b是确定变量，只需要调x的参数，就可以使用闭包的方法

```python
def line_conf(a, b):
    def line(x):
        return a*x + b
    return line

line1 = line_conf(1, 1)
line2 = line_conf(4, 5)
print(line1(5))
print(line2(5))
```

如果拿函数定义的方法来解决的话，就要不断的输入3个参数，这样显得更麻烦，所以闭包在一定程度上提高了代码复用率

## 闭包弊端

```
1.闭包似优化了变量，原来需要类对象完成的工作，闭包也可以完成
2.由于闭包引用了外部函数的局部变量，则外部函数的局部变量没有及时释放，会导致内存消耗很大，在一定程度上会影响性能
```
